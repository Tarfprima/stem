{% extends 'stem/base.html' %}
{% load static %}

{% block title %}–ü—Ä–æ—Ñ–∏–ª—å{% endblock %}

{% block content %}
<h1>–ü—Ä–æ—Ñ–∏–ª—å</h1>

<p>–í—Å–µ–≥–æ –∑–∞–¥–∞—á: {{ total_tasks }}</p>
<p>–ê–∫—Ç–∏–≤–Ω—ã—Ö: {{ active_count }}</p>
<p>–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö: {{ completed_count }}</p>

<h2>–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏</h2>
<ul>
  {% for task in active_page %}
    <li class="task-item {% if task.reminder_time %}reminder{% else %}note{% endif %}">
      {% if task.reminder_time %}
        ‚è∞
      {% else %}
        üìù
      {% endif %}
      <strong>{{ task.title }}</strong>

      {% if task.description %}
        <p class="task-desc">{{ task.description }}</p>
      {% endif %}

      <div class="task-meta">
        <small>–°–æ–∑–¥–∞–Ω–æ: {{ task.created_at|date:"d.m.Y H:i" }}</small>
        {% if task.reminder_time %}
          <small class="reminder-time">
            –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: {{ task.reminder_time|date:"d.m.Y H:i" }}
          </small>
        {% endif %}
      </div>

      <div class="task-actions">
        <form method="post" action="{% url 'stem:complete_task' task.id %}" class="task-action-form">
          {% csrf_token %}
          <button type="submit" class="btn btn-complete">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</button>
        </form>
        <form method="post" action="{% url 'stem:delete_task' task.id %}" class="task-action-form">
          {% csrf_token %}
          <button type="submit" class="btn btn-delete">–£–¥–∞–ª–∏—Ç—å</button>
        </form>
      </div>
    </li>
  {% empty %}
    <li>–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á –Ω–µ—Ç.</li>
  {% endfor %}
</ul>

<div class="pagination">
  {% if active_page.has_previous %}
    <a href="?page={{ active_page.previous_page_number }}">‚Üê –ù–∞–∑–∞–¥</a>
  {% endif %}
  <span>–°—Ç—Ä. {{ active_page.number }} –∏–∑ {{ active_page.paginator.num_pages }}</span>
  {% if active_page.has_next %}
    <a href="?page={{ active_page.next_page_number }}">–í–ø–µ—Ä—ë–¥ ‚Üí</a>
  {% endif %}
</div>

<h2>–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏</h2>
<ul>
  {% for task in completed_tasks %}
    <li class="task-item completed">
      ‚úÖ <strong>{{ task.title }}</strong>
      <small>{{ task.created_at|date:"d.m.Y H:i" }}</small>
      <form method="post" action="{% url 'stem:delete_task' task.id %}" class="task-action-form">
        {% csrf_token %}
        <button type="submit" class="btn btn-delete">–£–¥–∞–ª–∏—Ç—å</button>
      </form>
    </li>
  {% empty %}
    <li>–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –Ω–µ—Ç.</li>
  {% endfor %}
</ul>
{% endblock %}
